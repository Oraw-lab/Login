#include "Malwares.h"
#include <fstream>
#include <sstream>
#include <string>
using namespace std;

/*
arugs = text - to insert to file
design = checking if malware in text
return = true - if malware exists, false if malware doesnt exists
*/
Malware::Malware(string _malwarePath)
{
    virusFile = _malwarePath;
}
bool Malware::isMalwareExists(string text){
    // checking if we loaded virus file into object
    if (!isVirusesLoaded)
        // loading virus if we didnt
        loadVirus();
    // going over the vector
    for (auto malware : malwares) {
        // if text.find didnt return npos returning true 
        if (text.find(malware) != std::string::npos)
            return true;
    }
    // we went over all vector returning true
    return false;
}

/*
arugs = None
design = using virus file to load all malware into vector\
return = None , chaning vector in object
*/
void Malware::loadVirus(){
    // creating fstream object
    fstream newFile;
    // opening file and loading malwares
    newFile.open(virusFile, ios::in);
    if (newFile.is_open()) {
        string line;
        // while there are lines in the text we continue 
        while (getline(newFile, line)) {
            // inserting line to vector
            malwares.push_back(line);
        }
    }
    // setting isVirusesLoaded to true 
    isVirusesLoaded = true;
    // exiting func
    return;
}
