#include "Malwares.h"
#include <fstream>
#include <sstream>
#include <string>
using namespace std;


bool Malware::isMalwareExists(string text){
    if (!isVirusesLoaded)
        loadVirus();
    for (auto malware : malwares) {
        if (text.find(malware) != std::string::npos)
            return true;
    }
    return false;
}

void Malware::loadVirus(){
    fstream newFile;
    newFile.open(virusFile, ios::in);
    if (newFile.is_open()) {
        string line;
        while (getline(newFile, line)) {
            malwares.push_back(line);
        }
    }
    isVirusesLoaded = true;
    return;
}
